View(EJN2025)
knitr::include_graphics("EJN2025_FLE_histogram.png")
EJNonlyParticipants <- read_csv("Single_Sess(EJN2025).csv)
EJNonlyParticipants <- read_csv("Single_Sess(EJN2025).csv")
spec(EJNonlyParticipants)
EJNonlyParticipants
#Participants who weren't also in JOV dataset
EJNonlyParticipants <- read_csv("Single_Sess(EJN2025).csv")
ggplot(EJNonlyParticipants, aes(x=FLE)) + geom_histogram() +
facet_grid(rows=vars(session)) +
xlab('FLE size (dva)') +
ggtitle('EJN2025-specific participants FLE')
ggplot(EJNonlyParticipants, aes(x=FLE)) + geom_histogram() +
#facet_grid(rows=vars(session)) +
xlab('FLE size (dva)') +
ggtitle('EJN2025-specific participants FLE')
ggplot(EJNonlyParticipants, aes(x=FLE)) + geom_histogram() +
#facet_grid(rows=vars(session)) +
xlab('FLE size (dva)') +
ggtitle('EJN2025-specific participants FLE')
ggplot(EJNonlyParticipants, aes(x=FLE)) + geom_histogram(bins=30) +
#facet_grid(rows=vars(session)) +
xlab('FLE size (dva)') +
ggtitle('EJN2025-specific participants FLE')
ggplot(EJNonlyParticipants, aes(x=FLE)) + geom_histogram() +
#facet_grid(rows=vars(session)) +
xlab('FLE size (dva)') +
ggtitle('EJN2025-specific participants FLE')
summary(EJNonlyParticipants$FLE)
sampleMean<- (EJNonlyParticipants$FLE)
sampleMean<- mean(EJNonlyParticipants$FLE)
sampleSD<-  sd(EJNonlyParticipants$FLE)
sampleSD
sampleMean
View(EJNonlyParticipants$FLE)
View(EJNonlyParticipants)
na_count <- sum(is.na(EJNonlyParticipants$FLE))
cat("Number of NAs in FLE:", na_count, "\n")
EJNonlyParticipants <- EJNonlyParticipants %>%
drop_na(FLE)
ggplot(EJNonlyParticipants, aes(x=FLE)) + geom_histogram() +
#facet_grid(rows=vars(session)) +
xlab('FLE size (dva)') +
ggtitle('EJN2025-specific participants FLE')
sampleMean<- mean(EJNonlyParticipants$FLE)
sampleSD<-  sd(EJNonlyParticipants$FLE)
sampleMean
sampleSD
mean_val <- mean(EJNonlyParticipants$FLE)
sd_val <- sd(EJNonlyParticipants$FLE)
# Create histogram with text
ggplot(EJNonlyParticipants, aes(x = FLE)) +
geom_histogram(bins = 30, fill = "steelblue", color = "black") +
annotate("text", x = Inf, y = Inf,
label = paste0("Mean = ", round(mean_val, 2), "\n",
"SD = ", round(sd_val, 2), "\n",
"σ = ", round(sd_val, 2)),
hjust = 1.1, vjust = 1.1, size = 5) +
labs(title = "EJN2025-specific participants FLE", x = "FLE (dva)", y = "Count") +
theme_minimal()
mean_val <- mean(EJNonlyParticipants$FLE)
sd_val <- sd(EJNonlyParticipants$FLE)
# Create histogram with text
ggplot(EJNonlyParticipants, aes(x = FLE)) +
geom_histogram(bins = 30, fill = "steelblue", color = "black") +
annotate("text", x = Inf, y = Inf,
label = paste0("Mean = ", round(mean_val, 2), "\n",
"SD = ", round(sd_val, 2), "\n",
"σ^2 = ", round(sd_val*sd_val, 2)),
hjust = 1.1, vjust = 1.1, size = 5) +
labs(title = "EJN2025-specific participants FLE", x = "FLE (dva)", y = "Count") +
theme_minimal()
ggplot(EJNonlyParticipants, aes(x=FLE)) + geom_histogram(bins=30) +
#facet_grid(rows=vars(session)) +
xlab('FLE size (dva)') +
ggtitle('EJN2025-specific participants FLE')
print("Tim: I think the nans are because their staircases did not converge and we excluded them")
print("Tim: I think the nans are because their staircases did not converge and we excluded them")
print("But i think this is where reanalysing the data later on, we could be more liberal maybe? Alex: I think we should do both")
wide <- myOverallJoV %>%
select(ID, dva, session) %>%
pivot_wider(
names_from = session,
values_from = dva,
names_prefix = "dva_"
)
s1s2scatter<- ggplot(wide, aes(x = dva_1, y = dva_2)) +
geom_point() +
labs(
x = "Session 1 dva",
y = "Session 2 dva"
) +
geom_vline(xintercept = 0, linetype = "dashed") +
geom_hline(yintercept = 0, linetype = "dashed") +
ggtitle("JoV FLE")
#geom_abline() #reveals reduction from S1 to S2, consitent with practice triggering faster sampling of position
show(s1s2scatter)
head(myOverallJoV)
write_csv(myOverallJoV, "myOverallJoV_readyForQualitativeTest.csv")
FGE<- readMat("FG_Values(JOV).mat"). # https://osf.io/s4aqg/files/8kvsm
FGE<- readMat("FG_Values(JOV).mat") # https://osf.io/s4aqg/files/8kvsm
View(FGE)
FLE
knitr::opts_chunk$set(echo = TRUE)
#install.packages("R.matlab")
library(R.matlab)
library(tidyverse)
library(here)
datadir <- here("publishedMotnPostnDataToLoad")
datadir
datadir <- here("publishedMotnPostnDataToLoad","osfstorageForCottierEtAl2023")
datadir
datadir <- here("publishedMotnPostnDataToLoad","osfstorageForCottierEtAl2023","Data","Effect files")
datadir
ls(datadir)
?ls
list.files(datadir)
datadir <- here("publishedMotnPostnDataToLoad","osfstorageForCottierEtAl2023","Data","Effect files")
#list.files(datadir)
FLE <- readMat(
file.path(datadir, "FLE_Values.mat")
)
FLE<- readMat("FLE_Values(JOV).mat") # https://osf.io/s4aqg https://osf.io/s4aqg/files/am9bu
file.path(datadir, "FLE_Values.mat")
list.files(datadir)
FLE <- readMat(
file.path(datadir, "FLE_Values.mat")
)
FLE
FLE <- readMat(
file.path(datadir, "FLE_Values.mat")
)
overallOfBothSessions<- FLE$FLE.Overall
overallOfBothSessions<- as_tibble(overallOfBothSessions)
sess1JoV<-  as_tibble(FLE$FLE.Sess1)
sess2JoV<-  as_tibble(FLE$FLE.Sess2)
FDE <- readMat(
file.path(datadir, "FD_Values.mat")
)
FDE
FDE$FD.PSE.Effect.Sess1
FDE
mat_files <- list.files(
datadir,
pattern = "\\.mat$",
full.names = TRUE
)
mat_files
for (f in mat_files) {
cat("\nFile:", basename(f), "\n")
mat <- readMat(f)
# component names delimited by $
cat(paste(names(mat), collapse = " $ "), "\n")
}
mat_files <- list.files(
datadir,
pattern = "\\.mat$",
full.names = TRUE
)
extract_sessions <- function(matfile) {
mat <- readMat(matfile)
nms <- names(mat)
sess_vars <- nms[
str_detect(nms, "(Sess1|Sess2|S1|S2)$")
]
tibble(
file = basename(matfile),
variable = sess_vars,
data = map(sess_vars, ~ mat[[.x]])
)
}
session_data <- map_dfr(mat_files, extract_sessions)
session_data
head(session_data)
FD.PSE
FDE$FD.PSE.Effect.Sess1
illusion_tables <- session_data %>%
mutate(
illusion = str_extract(file, "^[^_]+"),
session = case_when(
str_ends(variable, "Sess1") | str_ends(variable, "S1") ~ 1,
str_ends(variable, "Sess2") | str_ends(variable, "S2") ~ 2
)
) %>%
select(illusion, session, data) %>%
group_by(illusion, session) %>%
summarise(
participant = list(data[[1]][, 1]),
value       = list(data[[1]][, 2]),
.groups = "drop"
) %>%
group_by(illusion) %>%
group_map(~ {
tibble(
participant = c(.x$participant[[1]], .x$participant[[2]]),
session     = rep(.x$session, times = lengths(.x$participant)),
value       = c(.x$value[[1]], .x$value[[2]])
)
})
names(illusion_tables) <- unique(
session_data %>%
mutate(illusion = str_extract(file, "^[^_]+")) %>%
pull(illusion)
)
View(illusion_tables)
library(tidyverse)
all_illusions <- session_data %>%
mutate(
illusion = str_extract(file, "^[^_]+"),
session = case_when(
str_ends(variable, "Sess1") | str_ends(variable, "S1") ~ 1,
str_ends(variable, "Sess2") | str_ends(variable, "S2") ~ 2
)
) %>%
select(illusion, session, data) %>%
mutate(
participant = map(data, ~ .x[, 1]),
value       = map(data, ~ .x[, 2])
) %>%
select(-data) %>%
unnest(c(participant, value)) %>%
relocate(illusion, participant, session)
wide_illusions <- all_illusions %>%
select(illusion, participant, session, value) %>%
pivot_wider(
names_from  = session,
values_from = value,
names_prefix = "sess"
)
ggplot(wide_illusions, aes(x = sess1, y = sess2)) +
geom_point() +
facet_wrap(~ illusion, scales = "free") +
labs(
x = "Session 1 value",
y = "Session 2 value"
) +
theme_bw()
knitr::opts_chunk$set(echo = TRUE)
#install.packages("R.matlab")
library(R.matlab)
library(tidyverse)
library(here)
# https://osf.io/s4aqg https://osf.io/s4aqg/files/am9bu
datadir <- here("publishedMotnPostnDataToLoad","osfstorageForCottierEtAl2023","Data","Effect files")
list.files(datadir)
mat_files <- list.files(
datadir,
pattern = "\\.mat$",
full.names = TRUE
)
for (f in mat_files) {
cat("\nFile:", basename(f), "\n")
mat <- readMat(f)
# component names delimited by $
cat(paste(names(mat), collapse = " $ "), "\n")
}
mat_files <- list.files(
datadir,
pattern = "\\.mat$",
full.names = TRUE
)
extract_sessions <- function(matfile) {
mat <- readMat(matfile)
nms <- names(mat)
sess_vars <- nms[
str_detect(nms, "(Sess1|Sess2|S1|S2)$")
]
tibble(
file = basename(matfile),
variable = sess_vars,
data = map(sess_vars, ~ mat[[.x]])
)
}
session_data <- map_dfr(mat_files, extract_sessions)
head(session_data)
mat_files <- list.files(
datadir,
pattern = "\\.mat$",
full.names = TRUE
)
for (f in mat_files) {
cat("\nFile:", basename(f), "\n")
mat <- readMat(f)
# component names delimited by $
cat("components:",paste(names(mat), collapse = " $ "), "\n")
}
mat_files <- list.files(
datadir,
pattern = "\\.mat$",
full.names = TRUE
)
extract_sessions <- function(matfile) {
mat <- readMat(matfile)
nms <- names(mat)
sess_vars <- nms[
str_detect(nms, "(Sess1|Sess2|S1|S2)$")
]
tibble(
file = basename(matfile),
variable = sess_vars,
data = map(sess_vars, ~ mat[[.x]])
)
}
session_data <- map_dfr(mat_files, extract_sessions)
head(session_data)
all_illusions <- session_data %>%
mutate(
illusion = str_extract(file, "^[^_]+"),
session = case_when(
str_ends(variable, "Sess1") | str_ends(variable, "S1") ~ 1,
str_ends(variable, "Sess2") | str_ends(variable, "S2") ~ 2
)
) %>%
select(illusion, session, data) %>%
mutate(
participant = map(data, ~ .x[, 1]),
value       = map(data, ~ .x[, 2])
) %>%
select(-data) %>%
unnest(c(participant, value)) %>%
relocate(illusion, participant, session)
wide_illusions <- all_illusions %>%
select(illusion, participant, session, value) %>%
pivot_wider(
names_from  = session,
values_from = value,
names_prefix = "sess"
)
all_illusions
wide_illusions
session_data <- session_data %>%
filter(
!(file == "TG_Values.mat" &
str_detect(variable, "Effects\\.Sess[12]$"))
)
for (f in mat_files) {
cat("\nFile:", basename(f), "\n")
mat <- readMat(f)
# component names delimited by $
cat("components:",paste(names(mat), collapse = " $ "), "\n")
}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("R.matlab")
library(R.matlab)
library(tidyverse)
library(here)
# https://osf.io/s4aqg https://osf.io/s4aqg/files/am9bu
datadir <- here("publishedMotnPostnDataToLoad","osfstorageForCottierEtAl2023","Data","Effect files")
list.files(datadir)
mat_files <- list.files(
datadir,
pattern = "\\.mat$",
full.names = TRUE
)
for (f in mat_files) {
cat("\nFile:", basename(f), "\n")
mat <- readMat(f)
# component names delimited by $
cat("components:",paste(names(mat), collapse = " $ "), "\n")
}
mat_files <- list.files(
datadir,
pattern = "\\.mat$",
full.names = TRUE
)
extract_sessions <- function(matfile) {
mat <- readMat(matfile)
nms <- names(mat)
sess_vars <- nms[
str_detect(nms, "(Sess1|Sess2|S1|S2)$")
]
tibble(
file = basename(matfile),
variable = sess_vars,
data = map(sess_vars, ~ mat[[.x]])
)
}
session_data <- map_dfr(mat_files, extract_sessions)
head(session_data)
session_data <- session_data %>%
filter(
!(file == "TG_Values.mat" &
str_detect(variable, "Effects\\.Sess[12]$"))
)
session_data
all_illusions <- session_data %>%
mutate(
illusion = str_extract(file, "^[^_]+"),
session = case_when(
str_ends(variable, "Sess1") | str_ends(variable, "S1") ~ 1,
str_ends(variable, "Sess2") | str_ends(variable, "S2") ~ 2
)
) %>%
select(illusion, session, data) %>%
mutate(
participant = map(data, ~ .x[, 1]),
value       = map(data, ~ .x[, 2])
) %>%
select(-data) %>%
unnest(c(participant, value)) %>%
relocate(illusion, participant, session)
wide_illusions <- all_illusions %>%
select(illusion, participant, session, value) %>%
pivot_wider(
names_from  = session,
values_from = value,
names_prefix = "sess"
)
ggplot(wide_illusions, aes(x = sess1, y = sess2)) +
geom_point() +
facet_wrap(~ illusion, scales = "free") +
labs(
x = "Session 1 value",
y = "Session 2 value"
) +
theme_bw()
ggplot(wide_illusions, aes(x = sess1, y = sess2)) +
geom_point() +
facet_wrap(~ illusion, scales = "free") +
labs(
x = "Session 1 value",
y = "Session 2 value"
) +
# identity line
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
# zero reference lines
geom_vline(xintercept = 0, linetype = "dotdash") +
geom_hline(yintercept = 0, linetype = "dotdash") +
theme_bw()
wide_illusions %>%
filter(is.na(sess1) | is.na(sess2)) %>%
arrange(illusion, participant)
session_data
session_data
session_data
wide_illusions_complete <- wide_illusions %>%
group_by(illusion, participant) %>%
filter(!any(is.na(c(sess1, sess2)))) %>%
ungroup()
wide_illusions_complete %>%
summarise(
n_missing = sum(is.na(sess1) | is.na(sess2))
)
all_illusions %>%
group_by(illusion, participant) %>%
summarise(
n_sessions = n_distinct(session),
has_na = any(is.na(value)),
.groups = "drop"
) %>%
filter(n_sessions < 2 | has_na)
Change the code to have one column that says whether session1 is NA and another column that says whether session2 is NA
na_by_participant <- all_illusions %>%
group_by(illusion, participant) %>%
summarise(
sess1_na = any(session == 1 & is.na(value)),
sess2_na = any(session == 2 & is.na(value)),
.groups = "drop"
)
na_by_participant
na_by_participant %>%
filter(sess1_na | sess2_na)
# identify bad participants
bad_participants <- all_illusions %>%
group_by(illusion, participant) %>%
summarise(
sess1_na = any(session == 1 & is.na(value)),
sess2_na = any(session == 2 & is.na(value)),
.groups = "drop"
) %>%
filter(sess1_na | sess2_na) %>%
select(illusion, participant)
# remove them from the data
all_illusions_clean <- all_illusions %>%
anti_join(
bad_participants,
by = c("illusion", "participant")
)
bad_participants
all_illusions
wide_illusions <- all_illusions_clean %>%
select(illusion, participant, session, value) %>%
pivot_wider(
names_from  = session,
values_from = value,
names_prefix = "sess"
)
ggplot(wide_illusions, aes(x = sess1, y = sess2)) +
geom_point() +
facet_wrap(~ illusion, scales = "free") +
labs(
x = "Session 1 value",
y = "Session 2 value"
) +
# identity line
geom_abline(slope = 1, intercept = 0, linetype = "dotted") +
# zero reference lines
geom_vline(xintercept = 0, linetype = "dotdash") +
geom_hline(yintercept = 0, linetype = "dotdash") +
theme_bw()
frohlich_outliers <- all_illusions_clean %>%
filter(illusion == "Frohlich") %>%
group_by(participant) %>%
filter(any(value < -20, na.rm = TRUE)) %>%
arrange(participant, session)
frohlich_outliers
mat_files
mm<-readMat("/Users/alex/Documents/vision/motionPosition/TimothyCottier_Cottier/individ_diffs/qualitativeIndividDiffsMotnPostnIllusions/publishedMotnPostnDataToLoad/osfstorageForCottierEtAl2023/Data/Effect files/FD_Values.mat")
mm
mean(mm$FD.PSE.Effect.Sess1)
mean(mm$FD.PSE.Effect.Sess1,na.rm=T)
mean(mm$FD.PSE.Effect.Sess2,na.rm=T)
